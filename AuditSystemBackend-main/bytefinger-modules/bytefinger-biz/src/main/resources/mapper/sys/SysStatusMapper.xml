<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.bytefinger.toutuo.biz.status.mapper.SysStatusMapper">

    <!-- 通用查询映射结果 -->
    <resultMap id="BaseResultMap" type="com.bytefinger.toutuo.biz.status.domain.SysStatus">
        <id column="id" property="id"/>
        <result column="group_id" property="groupId"/>
        <result column="group_name" property="groupName"/>
        <result column="status_name" property="statusName"/>
        <result column="status" property="status"/>
        <result column="enable" property="enable"/>
        <result column="sort" property="sort"/>

        <collection property="sysStatusTurnList" column="id" select="listTurn"></collection>
    </resultMap>

    <!-- 通用查询映射结果 -->
    <resultMap id="StatusTurnResultMap" type="com.bytefinger.toutuo.biz.status.domain.SysStatusTurn">
        <id column="turn_id" property="id"/>
        <result column="status_id" property="statusId"/>
        <result column="next_status_id" property="nextStatusId"/>
    </resultMap>

    <select id="listByGroupId" parameterType="Integer" resultMap="BaseResultMap">
        SELECT *,
               (select group_name from sys_status_group where id = group_id) group_name
        FROM sys_status
        WHERE group_id = #{groupId}
        ORDER BY sort asc
    </select>

    <select id="listTurn" resultMap="StatusTurnResultMap">
        SELECT id as turn_id,
               status_id,
               next_status_id
        FROM sys_status_turn
        WHERE status_id = #{id}
    </select>

</mapper>