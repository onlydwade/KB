package com.bytefinger.toutuo.biz.item.service.impl;import com.baomidou.mybatisplus.core.toolkit.CollectionUtils;import com.bytefinger.toutuo.biz.audititem.domain.AuditItemCriteria;import com.bytefinger.toutuo.biz.item.domain.Item;import com.bytefinger.toutuo.biz.item.domain.ItemCriteria;import com.bytefinger.toutuo.biz.item.mapper.ItemCriteriaMapper;import com.bytefinger.toutuo.biz.item.mapper.ItemMapper;import com.bytefinger.toutuo.biz.item.service.IItemCriteriaService;import com.bytefinger.toutuo.biz.item.service.IItemService;import com.baomidou.mybatisplus.extension.service.impl.ServiceImpl;import lombok.AllArgsConstructor;import org.springframework.stereotype.Service;import java.util.List;import java.util.regex.Matcher;import java.util.regex.Pattern;/** * <p> * 审计项目 服务实现类 * </p> * * @author Jone * @since 2025-08-05 */@Service@AllArgsConstructorpublic class ItemServiceImpl extends ServiceImpl<ItemMapper, Item> implements IItemService {    private ItemMapper itemMapper;    private IItemCriteriaService itemCriteriaService;    @Override    public void add(Item item) {        String regex = "\\(([^)]+)\\)[^()]*$";        Pattern pattern = Pattern.compile(regex);        Matcher matcher = pattern.matcher(item.getItemCategory());        if (matcher.find()) {            item.setItemCategoryShort(matcher.group(1));        }        itemMapper.insert(item);        List<ItemCriteria> list = item.getItemCriterias();        if(!CollectionUtils.isEmpty(list)){            list.replaceAll(itemCriteria -> itemCriteria.setItemId(item.getId()));            itemCriteriaService.saveBatch(list);        }    }}