package com.bytefinger.toutuo.biz.projectextension.service.impl;import com.baomidou.mybatisplus.core.conditions.Wrapper;import com.baomidou.mybatisplus.core.toolkit.Wrappers;import com.baomidou.mybatisplus.extension.service.impl.ServiceImpl;import com.bytefinger.common.core.utils.ProjectStepMenuTreeUtils;import com.bytefinger.common.core.web.domain.vo.ProjectStepMenuVO;import com.bytefinger.toutuo.biz.projectextension.entity.ProjectStepExpansionMenu;import com.bytefinger.toutuo.biz.projectextension.mapper.ProjectStepExpansionMenuMapper;import com.bytefinger.toutuo.biz.projectextension.service.IProjectStepExpansionMenuService;import com.bytefinger.toutuo.biz.projectextension.service.IProjectStepExpansionService;import com.bytefinger.toutuo.biz.projectstep.domain.ProjectStepMenu;import com.bytefinger.toutuo.biz.projectstep.mapper.ProjectStepMenuMapper;import lombok.AllArgsConstructor;import org.springframework.stereotype.Service;import java.util.List;import java.util.stream.Collectors;/** * <p> * 拓后项目步骤菜单 * </p> * * @author ycj * @since 2023-03-23 */@Service@AllArgsConstructorpublic class ProjectStepExpansionMenuServiceImpl extends ServiceImpl<ProjectStepExpansionMenuMapper, ProjectStepExpansionMenu> implements IProjectStepExpansionMenuService {    private final ProjectStepExpansionMenuMapper projectStepExpansionMenuMapper;    @Override    public List<ProjectStepMenuVO> tree(Wrapper<ProjectStepExpansionMenu> queryWrapper) {       return tree(queryWrapper, null);    }    @Override    public List<ProjectStepMenuVO> tree(long parentId) {        List<ProjectStepMenuVO> treeEntities = getProjectStepMenuVOS(Wrappers.<ProjectStepExpansionMenu>lambdaQuery().orderByAsc(ProjectStepExpansionMenu::getSorts));        return ProjectStepMenuTreeUtils.listTreeByParentId(treeEntities, parentId);    }    @Override    public List<ProjectStepMenuVO> tree(Wrapper<ProjectStepExpansionMenu> queryWrapper, Integer isDocument) {        List<ProjectStepMenuVO> treeEntities = getProjectStepMenuVOS(queryWrapper);        return ProjectStepMenuTreeUtils.listTreeByDocument(treeEntities,isDocument);    }    private List<ProjectStepMenuVO> getProjectStepMenuVOS(Wrapper<ProjectStepExpansionMenu> queryWrapper) {        List<ProjectStepExpansionMenu> projectStepMenus = projectStepExpansionMenuMapper.selectList(queryWrapper);        List<ProjectStepMenuVO> treeEntities = projectStepMenus.stream().map(item -> new ProjectStepMenuVO()                .setId(item.getId())                .setParentId(item.getParentId())                .setName(item.getName())                .setCode(item.getCode())                .setLevel(item.getLevel())                .setSorts(item.getSorts())                .setIsDocument(item.getIsDocument())                .setOaApproval(item.getOaApproval())                .setOfflineApproval(item.getOfflineApproval())).collect(Collectors.toList());        return treeEntities;    }}